# 데이터 모델링의 이해
## 모델링의 정의

- 데이터 모델은 현실세계의 정보를 인간과 컴퓨터가 이해할 수 있도록 추상화하여 표현한 모델
- 현실세계를 데이터베이스에 표현하는 중간과정, 데이터의 구조(스키마)를 논리적으로 표현하기 위한 도구
- 현실세계를 추상화한 반영

## 데이터 모델링의 중요성 / 유의점

### 중요성

- 파급 효과
    데이터 주도 설계 관점에서 애플리케이션의 모든 의존성을 데이터를 향하게되므로, 데이터 모델링이 변화하면 애플리케이션 설계 자체도 크게 변화하게된다! 파급효과가 매우 큼
- 복잡한 정보 요구사항의 간결한 표현
    데이터 모델은 구축할 시스템의 정보 요구사항과 한계를 가장 명확하고 간결하게 표현할 수 있는 도구
- 데이터의 가치
   비지니스 데이터는 그 자체로 기업의 중요 자산이므로, 해당 데이터의 품질관리 측면에서 데이터 모델링은 중요

### 유의점

- 중복
    데이터가 중복저장되면 일관성 유지가 힘들어짐
- 비유연성
    데이터 모델이 수시로 변경되면 유지보수가 어려워짐
- 비일관성
    데이터 중복이 없더라도 비일관성이 발생할 수 있음(예를 들어 주문거래를 한적이 없는데, 입출금 내역이 존재한다던가하는 데이터 모순점)

## 데이터 모델링 3단계(개.논.물)

### 개념적 데이터 모델링
- 추상화 수준이 높고 업무 중심적이고 포괄적인 수준의 모델링
- 핵심 엔티티 도출과 관계설정이 가장 중요 

### 논리적 데이터 모델링
- 시스템으로 구축하고자 하는 업무에 대해 key, 속성, 관계등을 정확하게 표현하는 모델링
- 비즈니스 정보의 논리적인 구조와 규칙을 명확하게 표현하는 과정
- 정규화 시점
- 데이터 모델링 완료시점

### 물리적 데이터 모델링
- 실제로 데이터베이스에 이식할 수 있도록 성능, 저장 등 물리적인 성격을 고려하여 설계
- 실제로 물리적으로 어떻게 저장할것인지를 고려하는 단계

## 데이터 독립성 모델 스키마 3단계
> 애플리케이션과 영속성 계층 분리를 위한 DB 설계시점 스키마 정의라고 이해

### 내부 스키마
- DB가 물리적으로 저장된 형식을 정의
- 물리적 장치에서 데이터가 실제적으로 저장되는 방법을 표현하는 스키마

### 개념 스키마
- 구성 모든 사용자 관점을 통합한 조직 전체 DB를 기술하는것
- 모든 응용시스템들이나 사용자들이 필요로 하는 데이터를 통합한 조직 전체의 DB기술, DB에 저장되는 데이터와 그들간의 관계를 표현하는 스키마

### 외부 스키마
- 뷰 단계 여러 개의 사용자 관점으로 구성, 앱 단위에서 접근하는 DB 정의

### 데이터 모델링과 데이터 독립성의 관계

- 개념, 논리데이터 모델링은 일반적으로 개념 스키마에 대해 정의하는것!
- 물리적 모델링은 내부 스키마정의로 이해
- 애플리케이션의 변화에도 외부 스키마는 변할지언정, 개념스키마는 변하지 않는것이 튼튼한 설계이자 좋은 스키마 정의다.

## 데이터 모델링 3요소와 ERD
### 3요소
- 엔티티
- 관계
- 속성

### ERD
> <p>개념적 데이터 모델의 가장 대표적인 형태<br>
- 개체, 관계, 속성의 삼요소로 데이터를 묘사<br>
- 특정 DMBS를 고려X<br>
<img src="https://player.slidesplayer.org/88/15839223/slides/slide_28.jpg" alt="enter image description here"></p>
- <p>사각형 =&gt; 개체<br>
- 마름모 =&gt; 관계<br>
- 타원 =&gt; 속성<br>
- 이중타원 =&gt; 복합속성<br>
- 밑줄타원 =&gt; 기본키 속성<br>
- 복수타원 =&gt; 복합속성<br>
- 선 - 개체 타입과 속성을 연결</p>
<p>개체와 개체간의 관계는 대응수로 표현함</p>
<h4 id="관계의-대응수">관계의 대응수</h4>
<p>관계집합에서 각 개체들이 참여할수 있는 대응의 개수</p>
<ul>
<li>일 대 일</li>
<li>일 대 다</li>
<li>다 대 일</li>
<li>다 대 다</li>
</ul>

[추가 참조](https://github.com/jinia91/TIL/blob/master/DB%20%EC%84%A4%EA%B3%84%20%EB%AA%A8%EB%8D%B8%EB%A7%81/CH.02%20ERD.md)

# 엔티티

## 정의

- 변별할 수 있는 사물
- 데이터베이스 내에서 변별 가능한 객체
- 정보가 저장될수 있는 어떤 것
- 명사, 비지니스적 관심사, 어떤 것(Things)

## 특징

- 비즈니스 업무에 필요하고 관리하고자 하는 정보
- 유일한 식별자 존재
- 인스턴스의 집합이여야함(인스턴스가 두개이상)
- 반드시 속성이 두개이상 존재해야 하고 속성은 하나의 속성값을 가져야함
- 다른 엔티티와 관계가 존재해야함

## 엔티티 학술적 분류
### 유.무형
- 유형 엔티티
- 개념 엔티티
- 사건 엔티티

### 발생 시점
- 기본 엔티티
    다른 엔티티로부터 주 식별자를 상속받지 않고, 자신의 고유한 주식별자를 가진경우
- 중심 엔티티
    기본 엔티티로부터 발생되고, 그 업무에서 중심적인 역할을 하는 경우
- 행위 엔티티
    두개 이상의 부모엔터티로부터 발생하고, 자주 내용이 바뀌거나 데이터양이 증가하는 엔티티


# 속성

## 개념
> 사물의 성질, 특징, 또는 본질적인 성질, 업무에서 필요로하는 인스턴스로 관리하고자 하는 의미상 더이상 분리할 수 없는 최소 데이터 단위

## 특징
- 해당업무에서 필요하고 관리하고자 하는 정보
- 정규화 이론에 근거, 정해진 주식별자에 함수적 종속성을 가져야함
- 하나의 속성은 한개의 값만 가져야함, 만약 다중속성이라면 1차 정규화를 통해 별도의 엔티티를 만드는것이 바람직하다.

## 속성 학술적 분류
### 특성에 따라
- 기본 속성
    비즈니스상 필요하고 실제로 존재하는 기본적인 데이터들
- 설계속성
    비즈니스 규칙화를 위해 변형, 가공한 속성들로 코드성 속성, 일련번호등에 해당
- 파생속성
     비즈니스상 필요하여 연산된 데이터들로, 다른 속성들을 통해 연산할 수 있으므로 가급적 적게 만드는것이 바람직하다. 데이터 정합성에 문제가 생길 수 있음
### 엔티티 구성방식에 따라
- PK
- FK
- 일반

# 관계
## 개념
> 상호 연관성이 있는 상태, 엔티티의 인스턴스 사이의 논리적인 연관성으로서 존재의 형태로서나 행위로서 서로에게 연관성이 부여된 상태

## 관계 학술적 분류
### 존재에 의한 관계
> 팀 - 구성원과 같이 구성원이 팀에 존재함으로서 맺어지는 관계
### 행위에 의한 관계
> 회원 - 주문 처럼 회원이 주문을 함으로서 맺어지는 관계

### UML 클래스 다이어그램에서 연관관계 VS 의존관계
- 연관관계는 존재에 의한 관계에 해당, 실선으로 펴현
- 의존과계는 행위에 의한 관계에 해당, 점선으로 표현
- ERD를 그릴때는 위의 구분없이 모두 실선으로 관계 표현

## 관계 표기법
- 관계 명 : 관계 이름
- 관계 차수 : 몇대 몇 관계인지
- 관계 선택사양 : 필수인지, 선택인지

## 엔티티간 관계 도출시 체크사항
1. 두개의 엔티티 사시에 관심있는 연관규칙이 존재하는가?
2. 두개의 엔티티 사이에 정보의 조합이 발생되는가?
3. 업무 기술서, 장표에 관계연결에 대한 규칙이 서술되어 있는가?
4. 업무 기술서, 장표에 관계연결을 가능하게 하는 동사가 있는가?


# 식별자
## 개념
- 엔티티는 인스턴스의 집합이며, 인스턴스를 구분하는 기준이 바로 식별자
- Primary Key는 정확히는 물리 데이터 모델링 단계에서의 용어이며, 식별자는 논리 데이터 모델링 단계의 용어

## 특징
- 유일성 : 주 식별자에 의해 엔티티내에 모든 인스턴스들이 유일하게 구분되어야 한다.
- 최소성 : 주 식별자를 구성하는 속성의 수는 유일성을 마족하는 최소의 수가 되어야한다.
- 불변성 : 지정된 주식별자의 값은 자주 변하지 않는 것이어야 한다
- 존재성 : 주식별자가 지정이 되면 반드시 값이 들어와야 한다

## 식별자 학술적 분류
### 대표성 여부
- 주식별자
- 보조 식별자
   식별자로서 역할은 가능하나, 대표성이 없으므로 참조 관계 연결 하면 안됨(회원 엔티티에서 id가 존재하고, 주민번호같은것)
### 스스로 생성 여부
- 내부 식별자
- 외부식별자(FK)
### 속성수
- 단일 식별자
- 복합 식별자
### 대체 여부
- 본질 식별자
- 인조 식별자

## 자식 엔티티에서 FK를 PK로 사용할지에 대해
### 식별자 관계인경우(PK로 사용) - 본질 식별자
- 부모엔티티가 반드시 생성된후 자기 엔티티가 생성된느 상황
- 필수관계 - 1대1 혹은 1대 다

### 비식별자 관계인경우(독자적 PK사용) - 인조식별자
- 부모 없이 자식이 생성될 수 있는상황
- 엔티티별 데이터 생명주기 관리가 다른상황

> 실무적으로 식별자/비식별자 관계를 모두 고려하여 설계하기엔 난이도가 높다. 부모 엔티티의 식별자를 모두 상속받되, 독자적인 식별자도 따로 만드는 방식으로 테이블을 구현하면 실무상 더 관리하기가 편하므로 해당 방식으로 구현을 추천(- 김영한님 JPA 강의에서 발췌)<br>
> 하지만 이러한 외부 식별자 사용시에는 중복 데이터 insert에 취약할 수 있음. 결국 개발 편의성과 데이터 정합성간 트레이드 오프라고 생각됨


# 정규화
> 두.부.이.걸.다.줘

- 실무에서는 제3 정규화까지만 하는것이 일반적

## 제 1정규화 : 모든 속성은 반드시 하나의 값을 가져야한다
> (두) 도메인 정의로 속성한개만!

## 제 2정규화 : 엔티티의 일반속성은 주식별자 전체에 종속적이여야한다
, > (부) 부분적 함수 종속 제거
## 제 3정규화 : 엔터티의 일반속성 간에는 서로 종속적이지 않는다
> 이행 종속성 제거

## [참고](https://github.com/jinia91/TIL/blob/master/DB%20%EC%84%A4%EA%B3%84%20%EB%AA%A8%EB%8D%B8%EB%A7%81/CH.03%20%EB%85%BC%EB%A6%AC%EC%A0%81%EB%AA%A8%EB%8D%B8%EB%A7%81.md)

## 반정규화와 성능
- 데이터 중복을 허용하는 대신 선응 향상을 야기하는 것
- 조회성능은 향상되지만, 일반적으로 입력 수정 삭제 성능은 저하된다.

### 반정규화 절차
1. 반정규화 대상 조사
    - 범위처리빈도수 조사
    - 대량의 범위 처리 조사
    - 통계성 프로세스 조사
    - 테이블 조인 개수
2. 다른 방법유도 검토
    - 뷰 테이블
    - 클러스터링
    - 인덱스 조정
    - 앱단위 로직
3. 반정규화 적용
    - 테이블 반정규화
    - 속성의 반정규화
    - 관계의 반정규화

### 슈퍼 / 서브 타입 데이터 모델 변환 기술
- 개별로 발생되는 트랜잭션에 대해서는 개별 테이블로 구성
- 슈퍼타입 + 서브타입에 대해 발생되는 트랜잭션에 대해서는 슈퍼타입 + 서브타입 테이블로 구성
- 전체를 하나로 묶어 트랜잭션이 발생시엔 하나의 테이블로 구성
